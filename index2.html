<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>FreeFlow ‚Äî voice + kropla (ostre logo)</title>
<style>
:root{
  --txt:#f1f1f1;
  --accent:#00e5ff;
  --accent2:#ffb300;
  --bg-url: url("https://raw.githubusercontent.com/ndoemo02/Freeflo/main/Background.png");
  --logo-url: url("https://raw.githubusercontent.com/ndoemo02/Freeflo/main/Freeflow-logo.png");
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{height:100%}
body{
  margin:0; color:var(--txt);
  font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  overflow:hidden;
}

/* T≈ÅO */
.bg{
  position:fixed; inset:0; z-index:0;
  background-image: var(--bg-url);
  background-size: cover; background-position: center; background-repeat:no-repeat;
  transform: translateZ(0);
}
.bg::before{
  content:""; position:absolute; inset:0;
  background: radial-gradient(1200px 800px at 50% 20%, rgba(10,10,16,.28), rgba(10,10,16,.48)),
              linear-gradient(180deg, rgba(10,10,16,.12), rgba(10,10,16,.34));
}
.bg::after{
  content:""; position:absolute; inset:0;
  opacity:.02; pointer-events:none;
  background-image: radial-gradient(currentColor 1px, transparent 1px);
  background-size: 3px 3px;
}

/* Pasek u g√≥ry */
.topbar{
  position:fixed; inset:0 0 auto 0; height:56px; z-index:3000;
  display:flex; align-items:center; justify-content:space-between; padding:0 12px;
  background: linear-gradient(180deg, rgba(10,10,15,.82), rgba(10,10,15,.35));
  backdrop-filter: blur(8px);
  border-bottom:1px solid rgba(255,255,255,.06);
}
.brand{font-weight:800; letter-spacing:.5px}
.top-actions{display:flex; gap:8px}
.icon-btn{
  height:36px; min-width:40px; padding:0 10px; border:0; border-radius:12px;
  background: rgba(255,255,255,.06); color:var(--txt); font-size:18px; cursor:pointer;
  backdrop-filter: blur(6px); border:1px solid rgba(255,255,255,.12);
}
.icon-btn:active{transform:translateY(1px)}
.badge{font-size:12px;background:var(--accent2);color:#1a1a1a;padding:1px 6px;border-radius:999px;margin-left:4px}

/* Menu */
.dropdown{
  position:fixed; top:60px; right:10px; z-index:2500; display:none; flex-direction:column; gap:8px;
  background: rgba(16,18,28,.8); padding:10px; border-radius:14px;
  border:1px solid rgba(255,255,255,.12); box-shadow:0 10px 30px rgba(0,0,0,.35); backdrop-filter: blur(10px);
}
.dropdown.open{display:flex}
.dropdown button{
  background: rgba(255,255,255,.06); color:var(--txt); border:0; border-radius:10px;
  padding:10px 12px; cursor:pointer; text-align:left; border:1px solid rgba(255,255,255,.1);
}
.dropdown button:hover{background: rgba(255,255,255,.1)}

/* BANER autoplay */
.toast{
  position:fixed; left:50%; transform:translateX(-50%); top:64px; z-index:2600;
  background: rgba(20,24,36,.92); color:var(--txt);
  border:1px solid rgba(255,255,255,.12); padding:10px 14px; border-radius:12px; font-size:14px; display:none;
  backdrop-filter: blur(8px);
}
.toast.show{display:block}

/* ---- KROPLA ---- */
.logo-zone{
  position:fixed; top:72px; left:50%; transform:translateX(-50%);
  width:min(76vw,380px); aspect-ratio:2/3; z-index:2000;
  filter: drop-shadow(0 10px 20px rgba(0,0,0,.6));
}
.logo-img{
  position:absolute; inset:0; width:100%; height:100%; object-fit:contain;
  image-rendering:auto;
  mix-blend-mode:screen;                 /* czarne ‚Üí znika, neony ostre */
  filter: saturate(1.08) contrast(1.06);
  transition: filter .25s ease, transform .25s ease;
}
.recording .logo-img{
  filter: saturate(1.18) contrast(1.12) brightness(1.08); /* ja≈õniej przy voice ON */
  transform: scale(1.01);
}

/* Hitbox maskowany (tylko do klikniƒôcia) */
.droplet{
  position:absolute; inset:0;
  -webkit-mask-image: var(--logo-url); mask-image: var(--logo-url);
  -webkit-mask-repeat:no-repeat; mask-repeat:no-repeat;
  -webkit-mask-position:center; mask-position:center;
  -webkit-mask-size:contain; mask-size:contain;
  background: transparent; border:0; backdrop-filter:none;
}

/* Neon/fale po OBWODZIE KROPLI */
.wave, .wave::before, .wave::after{
  content:""; position:absolute; inset:0; pointer-events:none;
  -webkit-mask-image: var(--logo-url); mask-image: var(--logo-url);
  -webkit-mask-repeat:no-repeat; mask-repeat:no-repeat;
  -webkit-mask-position:center; mask-position:center;
  -webkit-mask-size:contain; mask-size:contain;
}
.wave{ opacity:0; transition:opacity .25s ease; }
.wave::before{
  box-shadow: 0 0 18px rgba(0,229,255,.25), inset 0 0 12px rgba(0,229,255,.16);
  transform: scale(1.012); animation: breathe 2.4s ease-in-out infinite;
}
.wave::after{
  box-shadow: 0 0 26px rgba(0,229,255,.42), inset 0 0 20px rgba(0,229,255,.24);
  transform: scale(1.035); animation: spin 7s linear infinite;
}
.recording .wave{ opacity:1 }               /* mocniej tylko w nagrywaniu */
.clicked .logo-zone{ animation:pulse 500ms ease-out }

/* D√≥≈Ç: szklane pigu≈Çki */
.bottom-bar{
  position:fixed; left:50%; transform:translateX(-50%); bottom:14px; z-index:2200;
  display:flex; gap:10px; padding:6px;
  background: rgba(10,10,16,.35); border:1px solid rgba(255,255,255,.12);
  border-radius:16px; backdrop-filter: blur(10px);
}
.pill{
  display:flex; align-items:center; gap:8px;
  border:1px solid rgba(255,255,255,.14); border-radius:999px;
  padding:10px 14px; font-weight:700; cursor:pointer;
  background: rgba(255,255,255,.08); color:#fff;
  backdrop-filter: blur(8px);
}
.pill .ico{ font-size:18px; opacity:.95 }
.pill:active{ transform:translateY(1px) }
.pill:hover{ background: rgba(255,255,255,.12) }

/* Animacje */
@keyframes pulse{
  0%{ transform:translateX(-50%) scale(1); filter:drop-shadow(0 0 0 rgba(0,229,255,0)) }
  50%{ transform:translateX(-50%) scale(1.06); filter:drop-shadow(0 0 20px rgba(0,229,255,.55)) }
  100%{ transform:translateX(-50%) scale(1); filter:drop-shadow(0 0 0 rgba(0,229,255,0)) }
}
@keyframes spin{ to{ transform: rotate(360deg) } }
@keyframes breathe{ 0%,100%{ transform: scale(1.01) } 50%{ transform: scale(1.035) } }

@media (max-width:400px){
  .logo-zone{ width:78vw }
  .pill{ padding:10px 12px; font-size:15px }
}
</style>
</head>
<body>
  <!-- T≈ÅO -->
  <div class="bg" aria-hidden="true"></div>

  <!-- Topbar -->
  <header class="topbar">
    <div class="brand">FreeFlow</div>
    <nav class="top-actions">
      <button class="icon-btn" aria-label="Menu" onclick="toggleMenu()">‚ò∞</button>
      <button class="icon-btn" aria-label="Koszyk" onclick="openCart()">üõí <span class="badge" id="cartCount">0</span></button>
    </nav>
  </header>

  <!-- Menu -->
  <div class="dropdown" id="mainMenu">
    <button onclick="selectPay('blik')">P≈Çatno≈õƒá: BLIK</button>
    <button onclick="selectPay('karta')">P≈Çatno≈õƒá: Karta</button>
    <button onclick="selectPay('got√≥wka')">P≈Çatno≈õƒá: Got√≥wka</button>
  </div>

  <!-- Baner do odblokowania d≈∫wiƒôku -->
  <div id="audioToast" class="toast">üîä Stuknij, aby odtworzyƒá komunikat</div>

  <!-- KROPLA -->
  <div class="logo-zone" id="logoZone" onclick="toggleVoice()">
    <!-- Ostre logo (czer≈Ñ znika dziƒôki screen) -->
    <img class="logo-img"
         src="https://raw.githubusercontent.com/ndoemo02/Freeflo/main/Freeflow-logo.png"
         alt="FreeFlow logo">
    <!-- hitbox maskowany -->
    <div class="droplet"></div>
    <!-- neon po obrysie kropli -->
    <div class="wave"></div>
  </div>

  <!-- D√≥≈Ç -->
  <div class="bottom-bar">
    <button class="pill" onclick="quickIntent('Jedzenie')"><span class="ico">üçΩÔ∏è</span><span>Jedzenie</span></button>
    <button class="pill" onclick="quickIntent('Taxi')"><span class="ico">üöï</span><span>Taxi</span></button>
    <button class="pill" onclick="quickIntent('Hotel')"><span class="ico">üè®</span><span>Hotel</span></button>
  </div>

<script>
let cart = 0;
let recording = false;
let introSpoken = false;

/* Topbar */
function toggleMenu(){ document.getElementById('mainMenu').classList.toggle('open'); }
function openCart(){ alert('Koszyk (demo). Tu poka≈ºesz listƒô i checkout.'); }
function selectPay(type){ alert(`Wybrano metodƒô p≈Çatno≈õci: ${type.toUpperCase()}`); toggleMenu(); }

/* Intencje */
function quickIntent(kind){
  cart += 1; document.getElementById('cartCount').textContent = cart;
  speak(`Wybrano: ${kind}. Dodano do koszyka.`);
}

/* Voice ON/OFF */
function toggleVoice(){
  if(!introSpoken){ sayIntro(); } // je≈õli intro nie pad≈Ço, pu≈õƒá je najpierw
  recording = !recording;
  document.body.classList.toggle('recording', recording);
  document.body.classList.add('clicked');
  setTimeout(()=>document.body.classList.remove('clicked'), 500);

  if(recording){
    speak('Nagrywanie w≈ÇƒÖczone. S≈Çucham.');
    // startRecording(); // miejsce na realny capture (Whisper/WebRTC)
  }else{
    speak('Nagrywanie wy≈ÇƒÖczone.');
    // stopRecording();
  }
}

/* TTS (damski PL je≈õli dostƒôpny) */
function speak(text){
  try{
    const u = new SpeechSynthesisUtterance(text);
    u.lang = 'pl-PL';
    const voices = speechSynthesis.getVoices();
    const prefer = voices.find(v => v.lang.startsWith('pl') && /female|Zosia|Paulina|Agata|Agnieszka|Ewa|Maja/i.test(v.name));
    const anyPL = voices.find(v => v.lang.startsWith('pl'));
    u.voice = prefer || anyPL || null;
    u.rate = 1; u.pitch = 1; u.volume = 1;
    speechSynthesis.cancel();
    speechSynthesis.speak(u);
  }catch(e){ console.warn('SpeechSynthesis error:', e); }
}

/* Intro + autoplay policy */
const introText = 'W celu z≈Ço≈ºenia zam√≥wienia proszƒô nacisnƒÖƒá logo. Po aktywacji trybu voice dopytam o szczeg√≥≈Çy.';
function sayIntro(){
  if(introSpoken) return;
  introSpoken = true;
  hideToast();
  speak(introText);
}
function showToast(){ document.getElementById('audioToast').classList.add('show'); }
function hideToast(){ document.getElementById('audioToast').classList.remove('show'); }

function attachUnlockOnce(){
  const unlock = ()=>{
    sayIntro();
    window.removeEventListener('pointerdown', unlock, {passive:true});
    window.removeEventListener('touchstart', unlock, {passive:true});
    window.removeEventListener('click', unlock, {passive:true});
  };
  window.addEventListener('pointerdown', unlock, {passive:true});
  window.addEventListener('touchstart', unlock, {passive:true});
  window.addEventListener('click', unlock, {passive:true});
}
function tryAutoplay(){
  speak(introText);
  setTimeout(()=>{
    if(!speechSynthesis.speaking){
      showToast();
      attachUnlockOnce();
    }else{
      introSpoken = true;
      hideToast();
    }
  }, 700);
}

/* iOS/webview ‚Äî g≈Çosy mogƒÖ dochodziƒá asynchronicznie */
if(typeof speechSynthesis !== 'undefined'){
  speechSynthesis.onvoiceschanged = ()=>{};
}

window.addEventListener('load', tryAutoplay, {once:true});
</script>
</body>
</html>
