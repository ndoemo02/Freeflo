<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FreeFlow ‚Äì zam√≥w g≈Çosem</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --text:#e9eef6; --muted:#93a1b4; --brand:#ff7a00; --glass: rgba(0,0,0,.18);
      --border: rgba(255,255,255,.08);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--text);
      background:#0b0f14 url("assets/Background.png") center/cover fixed no-repeat;
    }

    /* top bar */
    .wrap{max-width:1100px;margin:0 auto;padding:16px}
    header{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
    h1{
      font-family: Poppins, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      font-weight:700; letter-spacing:.2px; margin:0; font-size: clamp(24px, 4.2vw, 44px);
      text-shadow: 0 4px 30px rgba(0,0,0,.45);
    }
    nav{margin-left:auto; display:flex; gap:8px; flex-wrap:wrap}
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 12px; border:1px solid var(--border); border-radius:999px;
      background: var(--glass); color:var(--text); cursor:pointer; user-select:none;
      backdrop-filter:saturate(120%) blur(8px);
      transition: transform .18s ease, background .18s ease, border-color .18s ease;
    }
    .chip:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.14);}
    .chip:active{ transform: translateY(0); }
    .chip i{font-style:normal; opacity:.9}

    /* hero + logo */
    .hero{margin:20px auto 14px; width:min(92vw,640px); aspect-ratio:1/1; display:grid; place-items:center}
    .logoBtn{border:none; background:transparent; padding:0; cursor:pointer}
    .logo-core{ width:78%; max-width:520px; display:block; filter:drop-shadow(0 10px 40px rgba(0,0,0,.55)); transition: transform .22s ease }
    .logo-core.listening{ animation:ff-pulse 1.2s ease-in-out infinite }
    @keyframes ff-pulse{ 0%{transform:scale(1)} 50%{transform:scale(1.035)} 100%{transform:scale(1)} }

    /* bubbles */
    .bubble{
      margin:10px auto 0; max-width:900px; padding:14px 16px; min-height:48px;
      background:var(--glass); border:1px solid var(--border); border-radius:14px;
      line-height:1.5; font-size:18px; backdrop-filter: blur(8px) saturate(120%);
      box-shadow: 0 6px 28px rgba(0,0,0,.25);
    }
    .note{ color:var(--muted); font-size:14px; margin-top:8px }

    /* toast (na komunikaty) */
    .toast{
      position:fixed; left:50%; bottom:16px; transform:translateX(-50%);
      background:#0f1520; color:#dfe7f3; border:1px solid rgba(255,255,255,.12);
      padding:10px 14px; border-radius:10px; box-shadow:0 10px 30px rgba(0,0,0,.35);
      opacity:0; pointer-events:none; transition:opacity .18s ease;
    }
    .toast.show{opacity:1}

    /* ma≈Çe ekrany */
    @media (max-width:640px){
      nav{ width:100%; margin-left:0 }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <h1>FreeFlow ‚Äì zam√≥w g≈Çosem</h1>
      <nav aria-label="Szybkie skr√≥ty">
        <button class="chip" data-intent="restaurant"><i>üçΩÔ∏è</i> Restauracja</button>
        <button class="chip" data-intent="taxi"><i>üöï</i> Taxi</button>
        <button class="chip" data-intent="hotel"><i>üè®</i> Hotel</button>
      </nav>
    </header>

    <section class="hero">
      <button id="micBtn" class="logoBtn" aria-label="Naci≈õnij, aby m√≥wiƒá">
        <!-- U≈ºywamy SVG (pulsuje) -->
        <img class="logo-core" src="assets/freeflow-logo.svg?v=7" alt="FreeFlow logo" />
      </button>
    </section>

    <div id="transcript" class="bubble">Powiedz, co chcesz zam√≥wiƒá‚Ä¶</div>
    <div class="note">Wskaz√≥wka: dzia≈Ça w Chrome/Edge (Web Speech API). Na iOS Safari u≈ºyj otwarcia w Chrome lub ‚ÄûDodaj do ekranu g≈Ç√≥wnego‚Äù.</div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    // szybkie podpowiedzi ‚Äì tylko wsadzamy tekst do bƒÖbla
    document.querySelectorAll('.chip').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const map = {
          restaurant: "Zarezerwuj stolik na dzi≈õ 19:30 w Katowicach, kuchnia w≈Çoska.",
          taxi: "Zam√≥w taks√≥wkƒô na 20:00 z Rynku w Katowicach do Pyrzowic.",
          hotel: "Znajd≈∫ pok√≥j 2-osobowy na dzi≈õ w centrum Krakowa."
        };
        const t = map[btn.dataset.intent] || "";
        if(t) document.getElementById('transcript').textContent = t;
      });
    });

    // TOAST helper
    const toast = (msg) => {
      const t = document.getElementById('toast');
      t.textContent = msg;
      t.classList.add('show');
      setTimeout(()=>t.classList.remove('show'), 1800);
    };

    // Web Speech API ‚Äì czysta transkrypcja
    const micBtn = document.getElementById('micBtn');
    const logo   = document.querySelector('.logo-core');
    const transcriptEl = document.getElementById('transcript');

    let recognition;
    let listening = false;

    if ('webkitSpeechRecognition' in window) {
      recognition = new webkitSpeechRecognition();
      recognition.lang = 'pl-PL';
      recognition.continuous = false;       // 1 fraza ‚Üí stop
      recognition.interimResults = true;    // pokazuj ‚Äûna ≈ºywo‚Äù

      recognition.onstart = () => {
        listening = true;
        logo.classList.add('listening');
        transcriptEl.textContent = "S≈Çucham‚Ä¶ üé§";
      };

      recognition.onresult = (event) => {
        let interim = '', final = '';
        for (let i = event.resultIndex; i < event.results.length; i++) {
          const res = event.results[i][0].transcript;
          if (event.results[i].isFinal) final += res;
          else interim += res;
        }
        transcriptEl.textContent = final || interim || "S≈Çucham‚Ä¶ üé§";
      };

      recognition.onerror = (e) => {
        logo.classList.remove('listening');
        listening = false;
        const msg = (e.error === 'not-allowed')
          ? "Brak zgody na mikrofon. Przyznaj uprawnienie w przeglƒÖdarce."
          : "B≈ÇƒÖd mikrofonu / rozpoznawania mowy.";
        toast(msg);
      };

      recognition.onend = () => {
        logo.classList.remove('listening');
        listening = false;
      };
    } else {
      // brak wsparcia
      document.querySelector('.note').textContent =
        "Twoja przeglƒÖdarka nie obs≈Çuguje rozpoznawania mowy. U≈ºyj Chrome/Edge lub Android.";
    }

    // start/stop nas≈Çuchu
    micBtn.addEventListener('click', () => {
      if (!recognition) return;
      if (listening) recognition.stop();
      else           recognition.start();
    });
  </script>
</body>
</html>
