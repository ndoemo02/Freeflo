<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>FreeFlow ‚Äì UI Lab</title>
<link rel="preload" href="Freeflow-logo.png" as="image">
<style>
  :root{
    --bg:#0c0f13;--panel:#12161c;--muted:#96a0ad;--text:#e9eef7;--accent:#ff7a1a;--accent-2:#ffb36b;
    --ring:#ff7a1a55;--ring-strong:#ff7a1a99;
  }
  *{box-sizing:border-box} html,body{height:100%} body{
    margin:0;background:radial-gradient(1200px 600px at 50% -200px,#15202b 0%,#0c0f13 55%,#0c0f13 100%);
    color:var(--text);font:400 16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    display:flex;flex-direction:column;gap:16px;
  }
  header{
    display:flex;align-items:center;justify-content:space-between;
    padding:16px 20px 0;
  }
  .brand{display:flex;align-items:baseline;gap:10px}
  .brand .logo{font-weight:800;font-size:34px;letter-spacing:.3px;color:var(--accent);text-shadow:0 4px 14px #000}
  .brand small{color:var(--muted);font-weight:500}
  .cart{position:relative;background:#151b23;border:1px solid #1f2a36;color:#cfe3ff;
    width:54px;height:54px;border-radius:16px;display:grid;place-items:center;box-shadow:0 8px 24px #0006}
  .cart-badge{position:absolute;top:-6px;right:-6px;background:var(--accent);color:#000;
    font-weight:800;font-size:13px;min-width:22px;height:22px;border-radius:999px;display:grid;place-items:center;box-shadow:0 6px 16px var(--ring)}
  main{padding:0 20px 90px;display:flex;flex-direction:column;gap:18px}
  h1{margin:0;font-size:44px;line-height:1.1;letter-spacing:.2px}
  .sub{color:#b8c2cf;margin-top:-6px}
  /* HERO MIC BUTTON */
  .hero{display:grid;place-items:center;margin-top:8px}
  .mic-wrap{position:relative;width:min(82vw,420px);aspect-ratio:1;display:grid;place-items:center;border-radius:999px;
    background:radial-gradient(60% 60% at 50% 42%,#0d1218 0%,#0b0f14 70%,transparent 100%);box-shadow:inset 0 0 0 2px #ffffff0e, 0 40px 120px #000a}
  .mic-ring{position:absolute;inset:-12px;border-radius:999px;border:2px dashed #ffffff12;opacity:.8;transition:.2s ease}
  .mic-btn{position:relative;z-index:2; border:none;background:transparent;padding:0;border-radius:999px;cursor:pointer;
    outline:none;display:grid;place-items:center;isolation:isolate}
  .mic-img{width:78%;filter:drop-shadow(0 18px 40px #000a)}
  .mic-copy{position:absolute;bottom:-10px;left:50%;transform:translateX(-50%);
    background:#0f141b;border:1px solid #1b2734;color:#cfd7e2;border-radius:14px;padding:8px 14px;font-weight:600;white-space:nowrap}
  .mic-wrap.listening .mic-ring{animation:pulse 1.2s ease-in-out infinite; border-color:var(--ring-strong)}
  .mic-wrap.listening .mic-copy{background:#121b24b0;border-color:#243446;color:#ffd5b5}
  @keyframes pulse {
    0%{box-shadow:0 0 0 0 var(--ring)} 70%{box-shadow:0 0 0 18px #ff7a1a00} 100%{box-shadow:0 0 0 0 #0000}
  }
  /* LIVE TRANSCRIPT IN BUTTON */
  .live-slot{
    position:absolute;inset:auto 8% 8% 8%;
    min-height:38px;display:none;align-items:center;justify-content:center;text-align:center;
    background:#0f141bcc;border:1px solid #243446;border-radius:12px;padding:8px 12px;color:#ffe1cc;
    font-weight:700;letter-spacing:.2px
  }
  .mic-wrap.listening .live-slot{display:flex}
  /* CATEGORY BAR */
  .cats{display:flex;gap:12px;justify-content:center;flex-wrap:wrap}
  .chip{display:flex;align-items:center;gap:10px;background:#121821;border:1px solid #1c2835;color:#dbe8ff;
    padding:12px 16px;border-radius:16px;font-weight:700}
  .chip .i{width:20px;height:20px;border-radius:6px;background:#192433;display:grid;place-items:center;color:var(--accent)}
  /* PROMPTS */
  .prompts{background:var(--panel);border:1px solid #1b2430;border-radius:22px;padding:18px;display:flex;flex-direction:column;gap:14px}
  .pill{background:#0f141b;border:1px solid #1d2835;color:#cfe3ff;border-radius:16px;padding:14px 16px}
  /* Variant switcher */
  .variants{position:fixed;left:0;right:0;bottom:0;padding:10px 12px;background:linear-gradient(#0000,#0008 30%,#000a);display:flex;gap:10px;justify-content:center;backdrop-filter:blur(8px)}
  .vbtn{width:38px;height:38px;border-radius:12px;border:1px solid #253241;background:#0f151c;color:#cfe3ff}
  .vbtn.active{background:var(--accent);border-color:#ff9b4a;color:#000;font-weight:800}
  /* Dodatkowe warianty (layoutowe mody) */
  /* v10 ‚Äì nasz bazowy */
  body.v10 .brand .logo{font-size:36px}
  body.v10 .mic-ring{border-style:solid}
  /* v1 ‚Äì kategorie pod tytu≈Çem, mniejszy hero */
  body.v1 .hero{margin-top:0} body.v1 .mic-wrap{width:min(78vw,360px)}
  body.v1 .cats{order:-1}
  /* v2 ‚Äì kategorie dokowane na dole */
  body.v2 .variants{padding-bottom:56px}
  body.v2 .cats{position:fixed;left:12px;right:12px;bottom:62px;justify-content:space-between}
  body.v2 .chip{flex:1;justify-content:center}
  /* v3 ‚Äì koszyk po lewej, sub copy mniejsze */
  body.v3 .cart{order:-1;margin-right:auto} body.v3 .sub{font-size:.95rem}
  /* v4 ‚Äì du≈ºy nag≈Ç√≥wek, hero 90%, jedno-delinowane copy */
  body.v4 h1{font-size:50px} body.v4 .mic-wrap{width:min(90vw,460px)}
  /* v5 ‚Äì ‚Äûglass‚Äù panel za hero */
  body.v5 .hero{padding:18px;border-radius:24px;background:linear-gradient(180deg,#121a2400,#121a2433)}
  /* v6 ‚Äì chipy z ikonami jako dock nad przyciskiem */
  body.v6 .cats{margin-top:-8px} body.v6 .chip{background:#0f141bd0;backdrop-filter:blur(6px)}
  /* v7 ‚Äì prompts w 2 kolumnach (na szerzej) */
  @media(min-width:700px){
    body.v7 .prompts{display:grid;grid-template-columns:1fr 1fr;gap:14px}
  }
  /* v8 ‚Äì ‚Äûpro‚Äù nag≈Ç√≥wek i badge Voice to order */
  body.v8 .brand small{background:#101721;border:1px solid #203044;border-radius:10px;padding:6px 9px}
  /* v9 ‚Äì ciemniejszy gradient t≈Ça, mocniejszy ring */
  body.v9{background:radial-gradient(1000px 520px at 50% -200px,#111a23 0%,#0a0e12 60%,#0a0e12 100%)}
  body.v9 .mic-ring{border-color:#ff7a1acc}
  /* v11 ‚Äì hero elipsa */
  body.v11 .mic-wrap{aspect-ratio:1/1.08}
  /* v12 ‚Äì kompakt mobile: mniejszy hero, wiƒôksze chipy */
  body.v12 .mic-wrap{width:min(70vw,330px)} body.v12 .chip{padding:14px 18px}
  /* small helpers */
  .hidden{display:none}
</style>
</head>
<body class="v10">
  <header>
    <div class="brand">
      <div class="logo">FreeFlow</div>
      <small>Voice to order</small>
    </div>
    <div class="cart" id="cartBtn" aria-label="Koszyk">
      üõí <div class="cart-badge" id="cartBadge">0</div>
    </div>
  </header>

  <main>
    <div>
      <h1>Z≈Ç√≥≈º zam√≥wienie</h1>
      <div class="sub">Taxi, posi≈Çek, a mo≈ºe nocleg?</div>
    </div>

    <section class="hero">
      <div class="mic-wrap" id="micWrap">
        <div class="mic-ring"></div>

        <!-- PRZYCISK ‚Äì w trakcie nas≈Çuchu napis znika, a tu wchodzi transkrypcja live -->
        <button class="mic-btn" id="voiceBtn" aria-label="M√≥w teraz">
          <img class="mic-img" src="Freeflow-logo.png" alt="FreeFlow ‚Äì mikrofon" />
          <div class="mic-copy" id="micCopy">Dotknij, aby zam√≥wiƒá</div>
          <div class="live-slot" id="liveSlot"></div>
        </button>
      </div>
    </section>

    <nav class="cats" id="cats">
      <button class="chip" data-prompt="Zam√≥w jedzenie w pobli≈ºu, mam ochotƒô na w≈ÇoskƒÖ kuchniƒô.">
        <span class="i">üçù</span> Jedzenie
      </button>
      <button class="chip" data-prompt="Zam√≥w taxi pod m√≥j adres najszybciej jak siƒô da.">
        <span class="i">üöï</span> Taxi
      </button>
      <button class="chip" data-prompt="Znajd≈∫ hotel w Krakowie od piƒÖtku na 2 noce.">
        <span class="i">üè®</span> Hotel
      </button>
    </nav>

    <section class="prompts" id="prompts">
      <div class="pill">‚Äûdwie pizze pepperoni‚Äù</div>
      <div class="pill">‚Äûzam√≥w taxi na Dworzec‚Äù</div>
      <div class="pill">‚Äûhotel w Krakowie od piƒÖtku na 2 noce‚Äù</div>
    </section>
  </main>

  <!-- Prze≈ÇƒÖcznik wariant√≥w -->
  <div class="variants" id="variants"></div>

<script>
/* ---------- warianty UI ---------- */
const MAX_VARIANTS = 12;
const variantsBar = document.getElementById('variants');
for(let i=1;i<=MAX_VARIANTS;i++){
  const b=document.createElement('button');
  b.className='vbtn'+(i===10?' active':'');
  b.textContent=i;
  b.addEventListener('click',()=>{
    document.body.className='v'+i;
    [...variantsBar.children].forEach(x=>x.classList.remove('active'));
    b.classList.add('active');
  });
  variantsBar.appendChild(b);
}

/* ---------- koszyk demo ---------- */
const cartBadge=document.getElementById('cartBadge');
const cartBtn=document.getElementById('cartBtn');
let cartCount=0;
cartBtn.addEventListener('click',()=>{ cartCount++; cartBadge.textContent=cartCount })

/* ---------- szybkie prompty ---------- */
document.getElementById('cats').addEventListener('click',(e)=>{
  const btn=e.target.closest('.chip'); if(!btn) return;
  speak(`OK, ${btn.textContent.trim()}.`);
  cartCount++; cartBadge.textContent=cartCount;
});

/* ---------- VOICE: live transcript w miejscu napisu ---------- */
const micWrap = document.getElementById('micWrap');
const voiceBtn = document.getElementById('voiceBtn');
const liveSlot = document.getElementById('liveSlot');
const micCopy  = document.getElementById('micCopy');

let recognition, listening=false, lastFinal='';

function initSTT(){
  if('webkitSpeechRecognition' in window){
    recognition = new webkitSpeechRecognition();
    recognition.lang='pl-PL';
    recognition.interimResults = true;
    recognition.continuous = false;

    recognition.onstart = ()=>{
      listening=true;
      micWrap.classList.add('listening');
      micCopy.classList.add('hidden');
      liveSlot.textContent='...';
    };

    recognition.onresult = (ev)=>{
      let interim='', final='';
      for(let i=0;i<ev.results.length;i++){
        const t=ev.results[i][0].transcript;
        if(ev.results[i].isFinal){ final += t+' '; }
        else{ interim += t; }
      }
      liveSlot.textContent = interim || final || '...';
      if(final) lastFinal = (lastFinal + ' ' + final).trim();
    };

    recognition.onerror = ()=>{
      stopListen(); micCopy.textContent='Spr√≥buj ponownie';
    };

    recognition.onend = ()=>{
      stopListen();
      if(lastFinal){
        // tutaj mo≈ºesz wys≈Çaƒá tekst do endpointu / GPT
        console.log('FINAL:', lastFinal);
        speak('Zrozumia≈Çem: ' + lastFinal);
        lastFinal='';
      }
    };
  } else {
    micCopy.textContent='Brak wsparcia rozpoznawania mowy';
  }
}

function startListen(){
  if(!recognition) return;
  try{ recognition.start(); }catch(e){ /* swallow */ }
}
function stopListen(){
  if(!listening) return;
  listening=false;
  micWrap.classList.remove('listening');
  micCopy.classList.remove('hidden');
  liveSlot.textContent='';
}

voiceBtn.addEventListener('click',()=>{
  if(!recognition) return;
  if(!listening) startListen(); else try{ recognition.stop(); }catch(e){}
});

initSTT();

/* ---------- prosta mowa zwrotna ---------- */
function speak(text){
  try{
    const u=new SpeechSynthesisUtterance(text);
    u.lang='pl-PL'; u.rate=1; u.pitch=1; u.volume=1;
    speechSynthesis.speak(u);
  }catch(e){}
}

/* ---------- estetyka: klik w przyk≈Çadowe frazy ---------- */
document.getElementById('prompts').addEventListener('click',(e)=>{
  const pill=e.target.closest('.pill'); if(!pill) return;
  lastFinal=pill.textContent.replace(/[‚Äû‚Äù]/g,'');
  speak('Zapisano: ' + lastFinal);
});
</script>
</body>
</html>
