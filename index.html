<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FreeFlow — Voice to Order</title>
  <style>
    :root{
      --bg:#0c0f12;
      --text:#e6e1d9;
      --accent:#ff7a1a; /* soczysty pomarańcz */
      --muted:#9aa0a6;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:radial-gradient(1200px 700px at 50% -200px,#111822 0%, #0d1218 40%, var(--bg) 100%);
      color:var(--text); font:400 16px/1.4 Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji", "Segoe UI Symbol";
      display:flex; align-items:center; justify-content:center;
    }
    .wrap{width:min(920px, 100%); padding:28px 20px 36px}
    header{ text-align:center; margin-bottom:16px;}
    .brand{
      font:800 clamp(36px,6vw,72px)/1.05 "Secular One", system-ui;
      letter-spacing:.5px; color:var(--accent); text-shadow:0 10px 30px rgba(255,122,26,.15);
      margin:0 0 6px;
    }
    .subtitle{
      font-weight:700; font-size: clamp(22px,4.4vw,40px); margin:0 0 6px; letter-spacing:.3px;
    }
    .hint{
      color:var(--muted); font-size:clamp(14px,2.6vw,18px); margin:0 0 28px;
    }

    /* CENTRUM: logo jako przycisk */
    .stage{
      display:grid; place-items:center; margin:12px auto 22px;
    }
    .mic-btn{
      position:relative;
      width:min(70vw, 380px);
      aspect-ratio:1/1;
      border-radius:999px;
      display:grid;
      place-items:center;
      border:none; background:none; cursor:pointer; outline:none;
      transform:translateZ(0);
      transition:transform .18s ease, filter .18s ease;
    }
    .mic-btn:active{ transform:scale(.98) }
    .mic-img{
      width:100%; height:100%; border-radius:50%;
      box-shadow:
        0 24px 60px rgba(0,0,0,.55),
        0 0 0 0 rgba(255,122,26,.0);
      transition:filter .2s ease, transform .25s ease, box-shadow .25s ease;
      user-select:none; -webkit-user-drag:none;
    }
    /* Puls logo (delikatny) */
    .mic-btn:hover .mic-img{ filter:saturate(1.05) drop-shadow(0 0 12px rgba(255,122,26,.25)); transform:scale(1.015); }

    /* Fale dookoła (3 pierścienie) */
    .waves{position:absolute; inset:0; pointer-events:none; filter:blur(.4px); }
    .waves::before, .waves::after, .wave3{
      content:""; position:absolute; inset:0; border-radius:50%;
      border:2px solid rgba(255,122,26,.22);
      transform:scale(.78); opacity:0;
    }
    .mic-btn.listening .waves::before{ animation:wave 1.6s ease-out infinite }
    .mic-btn.listening .waves::after{  animation:wave 1.6s .33s ease-out infinite }
    .mic-btn.listening .wave3{        animation:wave 1.6s .66s ease-out infinite }
    @keyframes wave{
      0%{ transform:scale(.80); opacity:.85 }
      70%{ opacity:.15 }
      100%{ transform:scale(1.35); opacity:0 }
    }

    /* Pierścień świecący podczas nasłuchu */
    .mic-btn.listening .mic-img{
      box-shadow:
        0 28px 70px rgba(0,0,0,.6),
        0 0 0 10px rgba(255,122,26,.08),
        0 0 0 22px rgba(255,122,26,.05);
      transform:scale(1.02);
      filter:saturate(1.08);
    }

    .under-hint{
      text-align:center; color:#cfc8be; opacity:.9;
      font-weight:600; letter-spacing:.2px; margin-top:8px;
    }

    /* Karta z przykładowymi frazami */
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.06);
      backdrop-filter: blur(6px);
      border-radius:18px; padding:18px; margin:20px auto 0; width:min(780px, 100%);
      box-shadow: 0 10px 28px rgba(0,0,0,.3);
    }
    .chips{ display:flex; flex-wrap:wrap; gap:10px; margin:6px 0 12px}
    .chip{
      padding:10px 14px; border-radius:12px;
      background:#141a21; border:1px solid rgba(255,255,255,.06);
      color:#d8d3ca; font-weight:600; letter-spacing:.2px;
    }
    .log{
      margin:0; padding:14px 12px; border-radius:12px; background:#0f141a;
      color:#cfd3d8; border:1px dashed rgba(255,255,255,.08); min-height:44px;
    }

    footer{ text-align:center; color:#808892; margin-top:20px; font-size:.95rem}
    a{ color:#ffd2b0; text-decoration:none }
    a:hover{ text-decoration:underline }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1 class="brand">FreeFlow</h1>
      <p class="subtitle">Złóż zamówienie</p>
      <p class="hint">Taxi, posiłek, a może nocleg?</p>
    </header>

    <section class="stage" aria-live="polite">
      <button id="micBtn" class="mic-btn" aria-label="Mów teraz – przytrzymaj lub kliknij">
        <!-- fale -->
        <span class="waves"></span><span class="wave3"></span>
        <!-- logo -->
        <img id="micImg" class="mic-img"
             src="Freeflow-logo.png"
             onerror="this.onerror=null; this.src=document.querySelector('[data-fallback]')?.dataset.fallback"
             alt="Logo FreeFlow z mikrofonem">
        <!-- ukryty fallback -->
        <img data-fallback style="display:none" src="file_000000000e9c62469156924aae2c3ff0.png" alt="">
      </button>
      <div class="under-hint">Dotknij, aby zamówić</div>
    </section>

    <section class="card">
      <div class="chips">
        <span class="chip">„dwie pizze pepperoni”</span>
        <span class="chip">„zamów taxi na Dworzec”</span>
        <span class="chip">„hotel w Krakowie od piątku na 2 noce”</span>
      </div>
      <p id="log" class="log">Słucham… powiedz, co zamawiasz.</p>
    </section>

    <footer>Demo: rozpoznanie mowy (Web Speech API) + odpowiedź głosowa (Speech Synthesis).</footer>
  </div>

  <script>
    // --- Rozpoznawanie mowy (Chrome/Android najlepiej) ---
    const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
    const synth = window.speechSynthesis;

    const btn = document.getElementById('micBtn');
    const log = document.getElementById('log');

    let recognition = null;
    let listening = false;

    function speak(text){
      if(!synth) return;
      const u = new SpeechSynthesisUtterance(text);
      u.lang = 'pl-PL';
      u.rate = 1.02;
      u.pitch = 1.0;
      synth.cancel();
      synth.speak(u);
    }

    function initSR(){
      if(!SR){ log.textContent = 'Twoja przeglądarka nie obsługuje rozpoznawania mowy (Web Speech API). Spróbuj w Chrome.'; return; }
      recognition = new SR();
      recognition.lang = 'pl-PL';
      recognition.interimResults = false;
      recognition.maxAlternatives = 1;

      recognition.onstart = () => { log.textContent = 'Nasłuchuję… mów śmiało.'; btn.classList.add('listening'); listening = true; };
      recognition.onend   = () => { btn.classList.remove('listening'); listening = false; };

      recognition.onerror = (e) => {
        btn.classList.remove('listening'); listening = false;
        log.textContent = 'Błąd rozpoznawania: ' + (e.error || 'nieznany');
      };

      recognition.onresult = (ev) => {
        const text = (ev.results[0] && ev.results[0][0] && ev.results[0][0].transcript) || '';
        log.textContent = 'Ty: ' + text;

        // Prosty router intencji (demo)
        const t = text.toLowerCase();
        let reply = 'Jasne. Co dokładnie podać?';
        if(t.includes('pizz') || t.includes('pepperoni')){
          reply = 'OK, dwie pizze pepperoni. Na wynos czy z dostawą?';
        }else if(t.includes('tax') || t.includes('dworzec')){
          reply = 'Zamawiam taxi na Dworzec. O której godzinie ma podjechać?';
        }else if(t.includes('hotel') || t.includes('noc') || t.includes('krakow') || t.includes('krakowie')){
          reply = 'Szukam hotelu w Krakowie. Jaki standard i daty przyjazdu/wyjazdu?';
        }else if(t.includes('anuluj') || t.includes('stop')){
          reply = 'Anulowano. Powiedz, gdy będziesz gotów.';
        }
        speak(reply);
        setTimeout(()=> log.textContent += '\nAsystent: ' + reply, 100);
      };
    }

    function toggleListen(){
      if(!recognition) { initSR(); if(!recognition) return; }
      try{
        if(!listening){ recognition.start(); }
        else { recognition.stop(); }
      }catch(e){
        // start() może rzucić, gdy trwa poprzednia sesja – spróbuj restartu
        try{ recognition.stop(); }catch(_){}
      }
    }

    // klik + krótka wibracja (na wspieranych)
    btn.addEventListener('click', () => {
      if(navigator.vibrate) navigator.vibrate(12);
      toggleListen();
    });

    // Inicjacja po pierwszym dotknięciu (iOS wymaga interakcji do TTS)
    window.addEventListener('click', ()=> {
      if(synth && synth.pending===false && synth.speaking===false){
        // "odblokuj" głos – cichy, natychmiast anulowany
        try{ const dummy = new SpeechSynthesisUtterance(''); synth.speak(dummy); synth.cancel(); }catch(_){}
      }
    }, { once:true });

    // start
    initSR();
  </script>
</body>
</html>
